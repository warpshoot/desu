<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>DESU‚Ñ¢ draw</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="light">
    <!-- „Ç≠„É£„É≥„Éê„ÇπÁôΩËÉåÊôØ -->
    <div id="canvas-background"></div>

    <!-- „É¨„Ç§„É§„Éºcanvas -->
    <canvas id="canvas-rough"></canvas>
    <canvas id="canvas-fill"></canvas>
    <canvas id="canvas-line"></canvas>
    <canvas id="canvas-line-2"></canvas>
    <canvas id="canvas-line-3"></canvas>
    <canvas id="lasso-canvas"></canvas>

    <!-- „Ç§„Éô„É≥„Éà„Ç≠„É£„Éó„ÉÅ„É£Áî®„ÅÆÈÄèÊòé„Ç≠„É£„É≥„Éê„Çπ (Â∏∏„Å´ÊúÄ‰∏ä‰Ωç) -->
    <canvas id="event-canvas"></canvas>

    <!-- Â∑¶‰∏ã„ÉÑ„Éº„É´„Éê„Éº -->
    <div id="toolbar-left">
        <div class="tool-group">
            <div class="tool-btn" id="penBtn" data-tool="pen" data-layer="line">
                <img src="icons/pen.png" class="tool-icon tool-pen" alt="Pen">
                <img src="icons/bet.png" class="tool-icon tool-fill" style="display:none;" alt="Fill">
                <img src="icons/ata.png" class="tool-icon tool-sketch" style="display:none;" alt="Sketch">
                <div class="tool-tooltip">„Éö„É≥ (1)</div>
            </div>
            <button class="layer-visible-btn" id="lineVisibleBtn" data-layer="line">
                <svg viewBox="0 0 24 24" class="eye-icon">
                    <path d="M2 12 C2 12 5 5 12 5 C19 5 22 12 22 12 C22 12 19 19 12 19 C5 19 2 12 2 12 Z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>
            <div class="opacity-slider-container" id="lineOpacityContainer">
                <input type="range" class="layer-opacity" id="lineOpacity" min="0" max="100" value="100"
                    data-layer="line">
            </div>
        </div>

        <div class="tool-group">
            <div class="tool-btn" id="penBtn2" data-tool="pen" data-layer="line2">
                <img src="icons/pen.png" class="tool-icon tool-pen" alt="Pen">
                <img src="icons/bet.png" class="tool-icon tool-fill" style="display:none;" alt="Fill">
                <img src="icons/ata.png" class="tool-icon tool-sketch" style="display:none;" alt="Sketch">
                <div class="tool-tooltip">„Éö„É≥ (2)</div>
            </div>
            <button class="layer-visible-btn" id="line2VisibleBtn" data-layer="line2">
                <svg viewBox="0 0 24 24" class="eye-icon">
                    <path d="M2 12 C2 12 5 5 12 5 C19 5 22 12 22 12 C22 12 19 19 12 19 C5 19 2 12 2 12 Z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>
            <div class="opacity-slider-container" id="line2OpacityContainer">
                <input type="range" class="layer-opacity" id="line2Opacity" min="0" max="100" value="100"
                    data-layer="line2">
            </div>
        </div>

        <div class="tool-group">
            <div class="tool-btn" id="penBtn3" data-tool="pen" data-layer="line3">
                <img src="icons/pen.png" class="tool-icon tool-pen" alt="Pen">
                <img src="icons/bet.png" class="tool-icon tool-fill" style="display:none;" alt="Fill">
                <img src="icons/ata.png" class="tool-icon tool-sketch" style="display:none;" alt="Sketch">
                <div class="tool-tooltip">„Éö„É≥ (3)</div>
            </div>
            <button class="layer-visible-btn" id="line3VisibleBtn" data-layer="line3">
                <svg viewBox="0 0 24 24" class="eye-icon">
                    <path d="M2 12 C2 12 5 5 12 5 C19 5 22 12 22 12 C22 12 19 19 12 19 C5 19 2 12 2 12 Z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>
            <div class="opacity-slider-container" id="line3OpacityContainer">
                <input type="range" class="layer-opacity" id="line3Opacity" min="0" max="100" value="100"
                    data-layer="line3">
            </div>
        </div>

        <div class="tool-group">
            <div class="tool-btn" id="fillBtn" data-tool="fill" data-layer="fill">
                <img src="icons/bet.png" class="tool-icon tool-fill" alt="Fill">
                <img src="icons/pen.png" class="tool-icon tool-pen" style="display:none;" alt="Pen">
                <img src="icons/ata.png" class="tool-icon tool-sketch" style="display:none;" alt="Sketch">
                <div class="tool-tooltip">Êäï„ÅíÁ∏ÑÂ°ó„Çä/Â°ó„Çä„Å§„Å∂„Åó (4)</div>
            </div>
            <button class="layer-visible-btn" id="fillVisibleBtn" data-layer="fill">
                <svg viewBox="0 0 24 24" class="eye-icon">
                    <path d="M2 12 C2 12 5 5 12 5 C19 5 22 12 22 12 C22 12 19 19 12 19 C5 19 2 12 2 12 Z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>
            <div class="opacity-slider-container" id="fillOpacityContainer">
                <input type="range" class="layer-opacity" id="fillOpacity" min="0" max="100" value="100"
                    data-layer="fill">
            </div>
        </div>

        <div class="tool-group">
            <div class="tool-btn active" id="sketchBtn" data-tool="sketch" data-layer="rough">
                <img src="icons/ata.png" class="tool-icon tool-sketch" alt="Sketch">
                <img src="icons/pen.png" class="tool-icon tool-pen" style="display:none;" alt="Pen">
                <img src="icons/bet.png" class="tool-icon tool-fill" style="display:none;" alt="Fill">
                <div class="tool-tooltip">ËñÑÊäï„ÅíÁ∏ÑÂ°ó„Çä/ËñÑÂ°ó„Çä„Å§„Å∂„Åó (5)</div>
            </div>
            <button class="layer-visible-btn" id="roughVisibleBtn" data-layer="rough">
                <svg viewBox="0 0 24 24" class="eye-icon">
                    <path d="M2 12 C2 12 5 5 12 5 C19 5 22 12 22 12 C22 12 19 19 12 19 C5 19 2 12 2 12 Z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>
            <div class="opacity-slider-container" id="roughOpacityContainer">
                <input type="range" class="layer-opacity" id="roughOpacity" min="0" max="100" value="100"
                    data-layer="rough">
            </div>
        </div>

        <div class="tool-btn" id="eraserBtn" data-tool="eraser">
            <img src="icons/er1.png" class="tool-icon eraser-lasso" alt="Eraser Lasso">
            <img src="icons/er2.svg" class="tool-icon eraser-pen" alt="Eraser Pen">
            <div class="tool-tooltip">Êäï„ÅíÁ∏ÑÊ∂à„Åó/Ê∂à„Åó„Å§„Å∂„Åó (6)</div>
        </div>

        <div class="tool-btn" id="layerClearBtn">
            <svg viewBox="0 0 24 24">
                <path
                    d="M12 4 L12 2 M12 22 L12 20 M4 12 L2 12 M22 12 L20 12 M6.34 6.34 L4.93 4.93 M19.07 19.07 L17.66 17.66 M6.34 17.66 L4.93 19.07 M19.07 4.93 L17.66 6.34" />
            </svg>
            <div class="tool-tooltip">„É¨„Ç§„É§„ÉºÊ∂àÂéª (7)</div>
        </div>

        <!-- „Éñ„É©„Ç∑„Çµ„Ç§„Ç∫„Çπ„É©„Ç§„ÉÄ„Éº -->
        <div id="size-slider-container">
            <div id="sizeDisplay">3</div>
            <input type="range" id="brushSize" min="1" max="20" value="3">
        </div>
    </div>

    <!-- „É¨„Ç§„É§„Éº„Ç≥„É≥„Éà„É≠„Éº„É´ (ÂâäÈô§Ê∏à„Åø - „ÉÑ„Éº„É´„Éê„Éº„Å´Áµ±Âêà) -->

    <!-- Âè≥‰∏ä„ÉÑ„Éº„É´„Éê„Éº -->
    <div id="toolbar-right">
        <!-- Color Pickers -->
        <div class="tool-btn" id="bgColorBtnWrapper">
            <div style="width: 100%; height: 100%; border-radius: 10px; overflow: hidden;">
                <input type="color" id="bgColorBtn" value="#ffffff" title="ËÉåÊôØËâ≤">
            </div>
            <div class="tool-tooltip tool-tooltip-bottom">ËÉåÊôØËâ≤</div>
        </div>

        <div class="tool-btn" id="saveBtn">
            <svg viewBox="0 0 24 24">
                <path d="M12 4 L12 16 M6 12 L12 18 L18 12" />
                <path d="M4 20 L20 20" />
            </svg>
            <div class="tool-tooltip tool-tooltip-bottom">‰øùÂ≠ò (‚åòS)</div>
        </div>

        <div class="tool-btn" id="clearBtn">
            <svg viewBox="0 0 24 24">
                <path
                    d="M12 4 L12 2 M12 22 L12 20 M4 12 L2 12 M22 12 L20 12 M6.34 6.34 L4.93 4.93 M19.07 19.07 L17.66 17.66 M6.34 17.66 L4.93 19.07 M19.07 4.93 L17.66 6.34" />
            </svg>
            <div class="tool-tooltip tool-tooltip-bottom">ÂÖ®Ê∂àÂéª (Del)</div>
        </div>
    </div>

    <!-- „Ç∫„Éº„É†„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥ -->
    <div id="resetZoomBtn">
        <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="8" />
            <path d="M12 7 L12 17 M7 12 L17 12" />
        </svg>
    </div>

    <!-- ‰øùÂ≠òUI -->
    <div id="save-overlay"></div>
    <div id="save-ui">
        <h3>ÁØÑÂõ≤„Çí„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶ÈÅ∏Êäû</h3>
        <div id="selection-size" style="display:none; font-size: 13px; color: #666; margin-bottom: 8px;"></div>

        <div class="option-group aspect-ratio-group">
            <div class="option-group-label">Á∏¶Ê®™ÊØî</div>
            <div class="option-buttons">
                <button class="option-btn active" data-aspect="free">Ëá™Áî±</button>
                <button class="option-btn" data-aspect="1:1">1:1</button>
                <button class="option-btn" data-aspect="4:5">4:5</button>
                <button class="option-btn" data-aspect="16:9">16:9</button>
                <button class="option-btn" data-aspect="9:16">9:16</button>
            </div>
        </div>

        <div class="option-group">
            <div class="option-group-label">ÂÄçÁéá</div>
            <div class="option-buttons">
                <button class="option-btn active" data-scale="1">1x</button>
                <button class="option-btn" data-scale="2">2x</button>
                <button class="option-btn" data-scale="3">3x</button>
            </div>
        </div>


        <label>
            <input type="checkbox" id="transparentBg">
            ËÉåÊôØÈÄèÈÅé
        </label>

        <div>
            <button class="save-btn" id="saveAllBtn">ÂÖ®‰Ωì„Çí‰øùÂ≠ò</button>
            <button class="save-btn primary" id="confirmSelectionBtn" style="display:none;">Á¢∫ÂÆö</button>
            <button class="save-btn" id="copyClipboardBtn" style="display:none;">„Ç≥„Éî„Éº</button>
            <button class="save-btn" id="redoSelectionBtn" style="display:none;">„ÇÑ„ÇäÁõ¥„Åó</button>
            <button class="save-btn" id="cancelSaveBtn">Èñâ„Åò„Çã</button>
        </div>
    </div>

    <canvas id="selection-canvas"></canvas>
    <div id="flash"></div>
    <div id="generating">
        <div><span class="spinner"></span>GIFÁîüÊàê‰∏≠...</div>
        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>
        <div id="progress-text">Ê∫ñÂÇô‰∏≠...</div>
    </div>

    <!-- „Éá„Éê„ÉÉ„Ç∞„É≠„Ç∞ -->
    <div id="debug-activator"></div>
    <div id="debug-toggle">üêõ</div>
    <div id="debug-log"></div>

    <!-- „ÇØ„É¨„Ç∏„ÉÉ„Éà„Éú„Çø„É≥„Å®„É¢„Éº„ÉÄ„É´ -->
    <div id="credit-btn">?</div>
    <div id="credit-modal">
        <div id="credit-content">
            <h2>DESU‚Ñ¢ draw</h2>
            <a href="https://warpshoot.github.io/desu/" target="_blank" id="credit-logo">
                <img src="../images/logo.gif" alt="DESU‚Ñ¢ draw">
            </a>
            <div id="credit-author">
                by <a href="https://warpshoot.github.io/" target="_blank">wpy</a>
            </div>
        </div>
    </div>

    <!-- Tool Mode Selection Menu (Popover) -->
    <!-- Tool Mode Selection Menu (Popover) -->
    <div id="tool-mode-menu" class="hidden">
        <!-- Drawing Modes -->
        <div class="menu-item drawing-mode" data-mode="pen">
            <img src="icons/pen.png" alt="Pen">
        </div>
        <div class="menu-item drawing-mode" data-mode="fill">
            <img src="icons/bet.png" alt="Fill">
        </div>
        <div class="menu-item drawing-mode" data-mode="sketch">
            <img src="icons/ata.png" alt="Sketch">
        </div>

        <!-- Eraser Modes -->
        <div class="menu-item eraser-mode" data-mode="eraser_lasso" style="display:none;">
            <img src="icons/er1.png" alt="Eraser Lasso">
        </div>
        <div class="menu-item eraser-mode" data-mode="eraser_pen" style="display:none;">
            <img src="icons/er2.svg" alt="Eraser Pen">
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/main.js"></script>
</body>

</html>